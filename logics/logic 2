Below is the **complete system definition and flow design** for:

# üî∑ LOGIC 2 ‚Äì Role-Based Access Control (RBAC)

---

# 1Ô∏è‚É£ PURPOSE OF RBAC IN A PROCUREMENT SYSTEM

RBAC ensures:

* Users can only perform authorized actions
* Separation of duties (SoD) is enforced
* No conflict-of-interest actions occur
* Institutional governance is maintained
* Auditability and legal defensibility are ensured

Without RBAC, procurement systems become legally and operationally risky.

---

# 2Ô∏è‚É£ CORE PRINCIPLES OF RBAC

### ‚úî Least Privilege

Users get the minimum permissions required.

### ‚úî Separation of Duties

No single user controls the full procurement lifecycle.

### ‚úî Contextual Access

Permissions depend on:

* Organization
* Tender
* Project
* Trust level (from Logic 1)

### ‚úî Traceability

Every permission-based action is logged.

---

# 3Ô∏è‚É£ HIGH-LEVEL ACCESS CONTROL FLOW

```
User Login
      ‚Üì
Authentication (MFA)
      ‚Üì
System Fetches:
   - Organization
   - Assigned Roles
   - Trust Level
      ‚Üì
Permission Matrix Evaluation
      ‚Üì
Access Token Issued (Scoped)
      ‚Üì
User Attempts Action
      ‚Üì
Authorization Check
      ‚Üì
Allow or Deny
      ‚Üì
Audit Log Entry
```

---

# 4Ô∏è‚É£ SYSTEM ACTOR TYPES

## üîπ A. Buyer-Side Roles

### Organization-Level Roles

| Role                        | Capabilities                      |
| --------------------------- | --------------------------------- |
| Super Admin                 | Full organization control         |
| Procurement Admin           | Create tenders, assign evaluators |
| Tender Creator              | Draft & publish tenders           |
| Evaluation Committee Member | Score bids                        |
| Finance Officer             | Budget approval                   |
| Contract Officer            | Issue awards                      |
| Auditor                     | Read-only oversight               |

---

## üîπ B. Supplier-Side Roles

| Role            | Capabilities             |
| --------------- | ------------------------ |
| Supplier Admin  | Manage company account   |
| Bid Manager     | Submit bids              |
| Finance Officer | Upload financial docs    |
| Legal Signatory | Digitally sign contracts |
| Viewer          | Read-only access         |

---

## üîπ C. Individual Professionals

| Role                 | Capabilities                |
| -------------------- | --------------------------- |
| Independent Bidder   | Submit proposals            |
| Consultant Evaluator | Score tenders (if assigned) |

---

## üîπ D. Platform-Level Roles

| Role               | Capabilities     |
| ------------------ | ---------------- |
| Platform Admin     | Global oversight |
| Compliance Officer | Risk review      |
| Technical Support  | Account recovery |
| Audit Supervisor   | System-wide logs |

---

# 5Ô∏è‚É£ PERMISSION MODEL STRUCTURE

RBAC operates at three levels:

### Level 1 ‚Äì System-Level Permissions

* Manage platform users
* View global analytics
* Override suspensions

### Level 2 ‚Äì Organization-Level Permissions

* Create tenders
* Approve budgets
* Assign committee members

### Level 3 ‚Äì Object-Level Permissions

* Access specific tender
* Edit specific bid
* View specific contract

---

# 6Ô∏è‚É£ PERMISSION MATRIX DESIGN

Example (Simplified):

| Action          | Buyer Admin | Evaluator | Supplier | Auditor |
| --------------- | ----------- | --------- | -------- | ------- |
| Create Tender   | ‚úÖ           | ‚ùå         | ‚ùå        | ‚ùå       |
| Publish Tender  | ‚úÖ           | ‚ùå         | ‚ùå        | ‚ùå       |
| Submit Bid      | ‚ùå           | ‚ùå         | ‚úÖ        | ‚ùå       |
| Evaluate Bid    | ‚ùå           | ‚úÖ         | ‚ùå        | ‚ùå       |
| Approve Award   | ‚úÖ           | ‚ùå         | ‚ùå        | ‚ùå       |
| View Audit Logs | ‚ùå           | ‚ùå         | ‚ùå        | ‚úÖ       |

---

# 7Ô∏è‚É£ SEPARATION OF DUTIES (SoD) LOGIC

Critical governance rule:

No single user can:

* Create tender
* Evaluate bids
* Approve award

The system must automatically prevent:

```
IF user = TenderCreator
AND user assigned as Evaluator
THEN system blocks assignment
```

Other SoD rules:

* Evaluator cannot see other scores before submission (blind scoring)
* Supplier cannot modify bid after deadline
* Finance cannot approve own budget submission

---

# 8Ô∏è‚É£ ROLE ASSIGNMENT FLOW

```
Organization Admin Invites User
        ‚Üì
User Accepts Invitation
        ‚Üì
Admin Assigns Role(s)
        ‚Üì
System Validates:
   - No SoD conflict
   - Role allowed by trust level
        ‚Üì
Permissions Activated
        ‚Üì
Audit Entry Logged
```

---

# 9Ô∏è‚É£ DYNAMIC PERMISSION LOGIC

Permissions may depend on:

### üîπ Trust Level (from Logic 1)

Example:

* Trust Level 1 suppliers cannot access high-value tenders.

### üîπ Tender Stage

Example:

* During evaluation phase:

  * Suppliers cannot edit bids.
  * Evaluators cannot change tender specs.

### üîπ Time Constraints

* After deadline ‚Üí submission locked.
* After award ‚Üí scoring locked.

---

# üîü ATTRIBUTE-BASED EXTENSIONS (ABAC Layer)

For advanced control, combine RBAC with attributes:

Access may depend on:

* Organization ID
* Tender value
* Geographic region
* Risk score
* Department
* Clearance level

Example rule:

```
Allow EvaluateBid
IF Role = Evaluator
AND AssignedToTender = TRUE
AND ConflictOfInterest = FALSE
AND EvaluationPhase = ACTIVE
```

---

# 1Ô∏è‚É£1Ô∏è‚É£ INTERNAL GOVERNANCE SUPPORT

RBAC supports:

### Dual Control

Example:

* Award requires:

  * Procurement approval
  * Finance approval

### Escalation Rules

If no approval within X days:

* Escalate to senior admin.

### Temporary Delegation

* Role reassignment during leave.
* Expiration date enforced.

---

# 1Ô∏è‚É£2Ô∏è‚É£ CONFLICT OF INTEREST CONTROL

System must:

* Detect shared ownership between buyer and supplier.
* Prevent evaluator from scoring a known related company.
* Block bidding by blacklisted entity.

If conflict detected:

```
Trigger Risk Flag
Freeze Action
Notify Compliance
```

---

# 1Ô∏è‚É£3Ô∏è‚É£ ACCESS TOKEN & SECURITY MODEL

After login:

* System generates scoped JWT token.
* Token includes:

  * User ID
  * Organization ID
  * Roles
  * Permission claims
  * Expiration time

All APIs validate:

* Token validity
* Permission scope
* Action authorization

---

# 1Ô∏è‚É£4Ô∏è‚É£ AUDIT & TRACEABILITY

Every permission-based action logs:

* User ID
* Role used
* Timestamp
* IP address
* Object affected
* Before/After state

Audit logs must be:

* Immutable
* Tamper-evident
* Retained per policy

---

# 1Ô∏è‚É£5Ô∏è‚É£ DATA STRUCTURE (DATABASE MODEL)

Core Tables:

* Users
* Organizations
* Roles
* Permissions
* Role_Permissions
* User_Roles
* Tender_Assignments
* Conflict_of_Interest_Records
* Audit_Logs

Relationships:

```
User ‚Üí User_Roles ‚Üí Roles ‚Üí Role_Permissions ‚Üí Permissions
```

---

# 1Ô∏è‚É£6Ô∏è‚É£ API ENFORCEMENT EXAMPLE

When user attempts to publish tender:

```
POST /tender/{id}/publish

System checks:
- Token valid?
- Role includes PublishTender?
- Tender status = Draft?
- User belongs to owning organization?
- No SoD violation?
```

If all true ‚Üí allow
Else ‚Üí 403 Forbidden

---

# 1Ô∏è‚É£7Ô∏è‚É£ SECURITY CONTROLS REQUIRED

* Multi-Factor Authentication (MFA)
* Session timeout policies
* IP anomaly detection
* Permission change logging
* Periodic role review
* Privileged access monitoring

---

# 1Ô∏è‚É£8Ô∏è‚É£ PERIODIC ACCESS REVIEW FLOW

To prevent privilege creep:

```
Quarterly Review Trigger
      ‚Üì
Organization Admin Receives Role Report
      ‚Üì
Confirm / Revoke Access
      ‚Üì
System Logs Changes
```

For high-risk organizations:

* Mandatory review every 90 days.

---

# 1Ô∏è‚É£9Ô∏è‚É£ EDGE CASE HANDLING

* User moves departments
* Merged organizations
* Emergency override access
* Suspended organization
* Legal injunction blocking actions

All must be handled with temporary permission states.

---

# 2Ô∏è‚É£0Ô∏è‚É£ COMPLETE END-TO-END RBAC SUMMARY

RBAC in procurement must:

* Clearly define actor roles
* Enforce separation of duties
* Prevent unauthorized cross-role actions
* Dynamically adjust permissions
* Maintain full audit traceability
* Integrate with trust and risk scoring

It is the **institutional governance engine** of the procurement ecosystem.

---

